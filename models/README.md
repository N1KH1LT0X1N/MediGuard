# Models Directory

This directory contains the trained machine learning model files for MediGuard AI.

## Files

### `disease_prediction_model.pkl`
- **Size:** ~1.0 MB
- **Purpose:** Contains the trained ensemble ML model
- **Type:** Gradient Boosting ensemble (stacking ensemble)
- **Usage:** Loaded by `PredictionService` and `ExplainabilityService`
- **Generated by:** `train_model.py` or training notebooks

### `label_encoder.pkl`
- **Size:** ~535 bytes
- **Purpose:** Maps numeric predictions to disease names
- **Type:** Scikit-learn LabelEncoder
- **Usage:** Converts model output (e.g., `2`) to disease name (e.g., `"Anemia"`)
- **Generated by:** `train_model.py` or training notebooks

## Model Details

- **Algorithm:** Stacking Ensemble (Gradient Boosting + Random Forest + SVM)
- **Input:** 24 clinical features (scaled to 0-1 range)
- **Output:** Disease prediction (Diabetes, Heart Disease, Anemia, etc.)
- **Training Data:** Combined dataset from `cleaned.csv` and `cleaned_test.csv`

## Usage

These files are automatically loaded at backend startup:
- `backend/main.py` loads both files during initialization
- `backend/services/prediction_service.py` uses them for predictions
- `backend/services/explainability_service.py` uses them for LIME explanations

## Regenerating Models

To regenerate these files:
```bash
python train_model.py
```

Or use the Jupyter notebooks in `ml/training&testing/`:
- `stacking_ensemble.ipynb`
- `alternative_ensembles.ipynb`

## Notes

- These files are required for the backend to function
- Do not delete or modify these files unless retraining the model
- Keep backups when updating models
- Model files are version-controlled (git) for reproducibility

